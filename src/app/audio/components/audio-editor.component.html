
<div class="editor" (wheel)="onWheel($event)">
  <div class="tracks">
    <!-- Header with fixed width columns -->
    <div class="tracks-header">
      <div class="head-spacer">
        <span class="time-display">{{ formatDuration(playhead()) }}</span>
      </div>
      <div class="ruler-container">
        <div class="ruler" #timeline (mousedown)="rulerMouseDown($event)">
          <div class="ticks" [style.width.px]="duration() * pxPerSecond()">
            <ng-container *ngFor="let i of getTimelineMarkers()">
              <div class="tick" [style.left.px]="i * pxPerSecond()">
                <span class="tick-label">{{ i }}s</span>
              </div>
            </ng-container>
          </div>
          <div class="playhead-ruler" [style.left.px]="(playhead() * pxPerSecond())"></div>
        </div>
      </div>
    </div>

    <!-- Tracks container for both heads and lanes -->
    <ng-container *ngFor="let track of tracks(); trackBy: trackByFn">
      <audio-track [track]="track"
                   [pxPerSecond]="pxPerSecond()"
                   [duration]="duration()"
                   [playhead]="playhead()"
                   [isDragOver]="dragOverTrack?.id === track.id"
                   (muteToggled)="onTrackMuteToggled($event)"
                   (soloToggled)="onTrackSoloToggled($event)"
                   (trackDeleted)="onTrackDeleted($event)"
                   (trackRenamed)="onTrackRenamed($event)"
                   (trackDrop)="onTrackDrop($event)"
                   (trackDragEnter)="onTrackDragEnter($event)"
                   (trackDragLeave)="onTrackDragLeave($event)"
                   (laneMouseDown)="laneMouseDown($event)"
                   (clipSelected)="onClipSelected($event)"
                   (clipDragStarted)="onClipDragStarted($event)"
                   (clipTrimStarted)="onClipTrimStarted($event)">
      </audio-track>
    </ng-container>

    <!-- Add Track Button -->
    <div class="add-track-container" *ngIf="tracks().length > 0">
      <button class="add-track-btn" 
              (click)="addTrack()" 
              mat-stroked-button>
        <mat-icon>add</mat-icon>
        Add Track
      </button>
    </div>
  </div>

  <!-- Sound Browser -->
  <sound-browser *ngIf="showSoundBrowser()"
                 (soundSelected)="onSoundSelected($event)"
                 (browserToggled)="toggleSoundBrowser()">
  </sound-browser>
</div>
